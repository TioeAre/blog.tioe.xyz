[{"content":"ä¸€ã€å®éªŒç›®çš„\nä½¿ç”¨å…‰æµï¼Œæ— äººæœºå®šä½æ¨¡å¼ æ‰¾æ— äººæœºçªç„¶å¤±æ§çš„åŸå›  äºŒã€å®éªŒè¿‡ç¨‹è®°å½•\né¦–å…ˆä½¿ç”¨å§¿æ€æ¨¡å¼èµ·é£ï¼Œæ— å¼‚å¸¸æƒ…å†µ æ¢ä¸ºä½ç½®æ¨¡å¼èµ·é£ï¼Œèµ·é£åå­˜åœ¨å·¦å³å°å¹…åº¦æ‘‡æ‘†åç§» é™è½æœªæ–­ç”µåé‡æ–°èµ·é£ï¼Œæ— äººæœºå¤±æ§å‘å·¦åæ–¹åç§»ç„¶åé¥æ§å™¨æ€¥åœ æœªæ–­ç”µé‡æ–°å°è¯•è§£é”ï¼Œä¸èƒ½è§£é”å¹¶æŠ¥é”™å¦‚ä¸‹å›¾ æ–­ç”µåå¯ä»¥è§£é”ï¼Œä½ç½®æ¨¡å¼ä»ç„¶å¤±æ§\né‡æ–°ä½¿ç”¨å§¿æ€èµ·é£ï¼Œå§¿æ€ä»ç„¶æ­£å¸¸\nä¸‰ã€å®éªŒç»“æœ\næŸ¥çœ‹æ—¥å¿—å‘ç°å§¿æ€ä¼°è®¡ç»“æœå¼‚å¸¸ï¼Œé£æœºæ°´å¹³æ”¾ç½®æ—¶ï¼Œé£æ§ä»ä¼šä»¥ä¸ºé£æœºå­˜åœ¨æ°´å¹³å€¾æ–œï¼Œåˆ¤æ–­æ˜¯å§¿æ€ä¼°è®¡å‡ºé”™å¯¼è‡´çš„å¤±æ§ è¿˜å‘ç°æŠ¥é”™imu stopped aiddingï¼Œçœ‹æºç å‘ç°åœ¨ekfæ»¤æ³¢å¼€å§‹å‰æœ‰ç›¸å…³åˆ¤æ–­ï¼Œå¹¶åœ¨ä¸‹å›¾ä¸¤å¤„ä¸ºPV_AidingModeèµ‹å€¼ä¸ºAID_NONEç„¶åæŠ¥é”™ï¼Œæ¨æµ‹æŠ¥é”™åŸå› ä¸ºå‚æ•°é‡Œek3_src1_yawæ²¡æœ‰èµ‹å€¼ ç»§ç»­è·³è½¬å‘ç°AID_NONEä¼šå¯¼è‡´æ»¤æ³¢ç»“æœé‡ç½®å’Œyawæ–¹å‘çš„èåˆï¼Œæ¨æµ‹æ˜¯è¿™ä¸ªåŸå› å¯¼è‡´çš„å§¿æ€ä¼°è®¡é”™è¯¯ ç„¶è€Œek3_src1_yawè¿™ä¸ªå‚æ•°åªæœ‰none, Compass, GPS, GPS with Compass Fallback, ExternalNav, GSFå‡ ç§ï¼Œåªèƒ½é€‰compassï¼Œä½†æ˜¯åˆä¼šæŠ¥é”™compass unhealthyï¼Œå°šæœªè§£å†³ 2023.06.24:\nåç»­å‘ç°kakute minié£æ§ä¸­å¹¶æ²¡æœ‰ç£åŠ›è®¡, æ¿è½½imuåªæœ‰åŠ é€Ÿåº¦è®°å’Œé™€èºä»ª. å¤–ç½®ç£åŠ›è®¡åèƒ½å¤Ÿè·³å‡ºè¯¥åˆ¤æ–­æ¡ä»¶, é¿å…ä¼°è®¡çš„çŠ¶æ€é‡å’Œè§‚æµ‹å€¼æ¸…é›¶. åœ¨å¤§è§’åº¦æ—‹è½¬æ— äººæœº, çŠ¶æ€å› å…‰æµæµ‹ç®—å¼‚å¸¸è€Œä¼°è®¡é”™è¯¯åèƒ½å¤Ÿè‡ªåŠ¨è¿”å›æ­£ç¡®çš„å§¿æ€\næ­¤æ—¶ä»å­˜åœ¨å®¤å†…å®šä½æ¼‚ç§»ä»¥åŠä½¿ç”¨å…‰æµçš„æ¿€å…‰æµ‹é«˜æ¨¡å—ä¼šä½¿é«˜åº¦ä¼°è®¡å¤±æ§çš„æƒ…å†µ, ä¸‹ä¸€æ­¥ä¹°å›æ¥è‡ªå¸¦é™€èºä»ªè¡¥å¿çš„px4flowåå†è¿›è¡Œå®éªŒæ‰¾åˆ°é—®é¢˜\n","date":"2023-06-15T19:30:45+08:00","image":"https://raw.githubusercontent.com/TioeAre/imageHost/main/pictures/103449092_p0_master1200.jpg","permalink":"https://www.blog.tioe.xyz/daily/2023.06.15/","title":"è°ƒè¯•å®¤å†…å®šä½"},{"content":"Ardupilotè¡¥å¿å…‰æµ é—®é¢˜æ¦‚è¿° ä¸»è¦é—®é¢˜: å…‰æµä¼ æ„Ÿå™¨å‡å®šæ— äººæœºä¸ºå®Œå…¨æ°´å¹³é£è¡Œ, å½“æ— äººæœºå§¿æ€å‘ç”Ÿå¾®å°å€¾æ–œæ—¶, å…‰æµè®¤ä¸ºæ­¤æ—¶æ— äººæœºæœ‰ä½ç§», è¿›è€Œè¾“å‡ºè¯¥ä½ç§»æ•°æ®, å¯¼è‡´Loiteræ¨¡å¼ä¸‹å‡ºç°å·¦å³æµ®åŠ¨\nè¡ç”Ÿé—®é¢˜: 1.å…‰æµæ¨¡å—å¹¶ä¸åœ¨æ— äººæœºæ—‹è½¬ä¸­å¿ƒ, å½“æ— äººæœºä½å§¿å‘ç”Ÿå˜åŒ–æ—¶, å…‰æµæ¨¡å—çš„æ—‹è½¬è§’é€Ÿåº¦ä¸imuçš„è§’é€Ÿåº¦ä¸ä¸€å®šç›¸åŒ. 2.å…‰æµæ•°æ®çš„é¢‘ç‡ä¸imuå‘å¸ƒé¢‘ç‡ä¸ä¸€å®šç›¸åŒ, ä¸­é—´å¯èƒ½å‡ºç°æ—¶é—´å·®å½±å“è¡¥å¿æ•ˆæœ\nèåˆæ–¹æ¡ˆ ä»£ç ä¿®æ”¹ è·å–å…‰æµå¾—åˆ°çš„xè½´å’Œyè½´é€Ÿåº¦ è·å–åŠ é€Ÿåº¦è®¡å¾—åˆ°çš„pitchå’Œrollè½´é€Ÿåº¦ å°†åŠ é€Ÿåº¦è®¡å¾—åˆ°çš„æ•°æ®è½¬åŒ–ä¸ºå…‰æµåæ ‡ç³»ä¸‹çš„é€Ÿåº¦ å…‰æµé€Ÿåº¦å‡å»åŠ é€Ÿåº¦è®¡é€Ÿåº¦å³å¯ å‚è€ƒ[4], [5]ä¸­çš„ä»£ç \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 ///å‚è€ƒèµ„æ–™[4] Flow_Decode(\u0026amp;Flow_Buffer[0]);\t// å…‰æµæ•°æ®è§£æ TimePeriod(\u0026amp;flow_Delta);\t// å¾—åˆ°è¿™æ®µä»£ç è¿è¡Œæ—¶é—´ms Flow_Delta_T = Flow_Delta.Time_Delta/1000.0f;\t// å¾—åˆ°å‘¨æœŸæ—¶é—´ // å¾—åˆ°é™€èºä»ªæ•°æ®è§’é€Ÿåº¦(å¼§åº¦) gyro_y = imu.gyroRaw[1] * 180.0f / M_PI_F;\t// gyro[1] pitchå…‰æµYè½´ gyro_x = imu.gyroRaw[0] * 180.0f / M_PI_F;\t// gyro[0] rollå…‰æµXè½´ // é™€èºä»ªæ»¤æ³¢ LPF_1_(8.0f, Flow_Delta_T, gyro_y, gyro_lpf_y);\t// gyro low pass filter (delay) for fitting flow data() LPF_1_(8.0f, Flow_Delta_T, gyro_x, gyro_lpf_x);\t// 8.0éœ€è¦è°ƒå‚, ä¿è¯å…‰æµæ•°å€¼å’Œé™€èºä»ªæ•°å€¼ç›¸ä½ç›¸å·®ä¸å¤š // å¯¹å…‰æµåŸå§‹æ•°æ®è¿›è¡Œæ»¤æ³¢ LPF_1_(30.0f, Flow_Delta_T, flow_dat.x, flow_dat.x);\t// å¯¹å…‰æµæ•°æ®è¿›è¡Œç®€å•æ»¤æ³¢ LPF_1_(30.0f, Flow_Delta_T, flow_dat.y, flow_dat.y); // é€Ÿåº¦è®¡ç®—æ–¹æ³•: (H * flow_dat.x / T) * 100 Hä¸ºé«˜åº¦, å•ä½m. Tä¸ºé—´éš”æ—¶é—´, å•ä½s, 100æ˜¯m-\u0026gt;cmçš„è½¬æ¢ UPflow_speed_x = flow_dat.x / Flow_Delta_T ; // é€Ÿåº¦ rad/s UPflow_speed_y = flow_dat.y / Flow_Delta_T ; // é€Ÿåº¦ rad/s /* --------------------åˆ©ç”¨é™€èºä»ªå¯¹å…‰æµè¿›è¡Œè¡¥å¿ï¼Œä¿è¯åœ¨åŸåœ°æ—‹è½¬æ—¶ï¼Œå…‰æµè¾“å‡ºå‡ ä¹ä¸º 0 -----------------*/ // 1.105å’Œ1.101ç³»æ•°éœ€è¦è°ƒå‚, ç”¨æ¥æŠµæ¶ˆä½é€šæ»¤æ³¢å¸¦æ¥çš„å¹…å€¼å‡å° UPflow_speed_x = US100_Distance * (UPflow_speed_x - 1.105 * LIMIT(((gyro_lpf_x) / 57.295779f), -flow_t2, flow_t2)) * 100.0f;\t// é€Ÿåº¦ cm/s UPflow_speed_y = US100_Distance * (UPflow_speed_y + 1.101 * LIMIT(((gyro_lpf_y) / 57.295779f), -flow_t1, flow_t1)) * 100.0f; å…¶ä¸­Flow_Decode(), LPF_1_(), LIMIT()å‡½æ•°ç”±è¯¥åšä¸»ä½¿ç”¨çš„å…‰æµæ¨¡å—å‚å®¶æä¾›, ç”¨äºè·å–å…‰æµé€Ÿåº¦å’Œæ»¤æ³¢ç­‰\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 /// å‚è€ƒèµ„æ–™[5] if (get_flow_quality() != 0) { flow_angle_fix_x = +(120.0f * tan(pitch_delay[3])); flow_angle_fix_y = -(120.0f * tan(roll_delay[3])); } else { flow_angle_fix_x = 0; flow_angle_fix_y = 0; } flow_cal_distance_x = flow_ori_distance_x - flow_angle_fix_x; // cm flow_cal_distance_y = flow_ori_distance_y - flow_angle_fix_y; // cm float flow_speed_x = (flow_cal_distance_x - last_distance_x) / 0.02f; float flow_speed_y = (flow_cal_distance_y - last_distance_y) / 0.02f; last_distance_x = flow_cal_distance_x; last_distance_y = flow_cal_distance_y; ä»¥ä¸Šä¸¤ç¯‡ä¸­ä¸»è¦æ€æƒ³éƒ½æ˜¯é€šè¿‡å…‰æµçš„æ¨¡å—çš„ç›¸å…³å‡½æ•°è·å–åˆ°å…‰æµçš„æ•°æ®, ç„¶åå°†è¯¥æ•°æ®ä¹˜ä»¥ä¸€ä¸ªéœ€è¦è‡ªå·±è°ƒæ•´çš„å‚æ•°, ç„¶åå†å‡å»ä»imuè·å¾—çš„æ•°æ®.\nä¸åŒç‚¹æ˜¯[4]ä¸­ç›´æ¥è·å–çš„å…‰æµé€Ÿåº¦ç„¶ååˆ©ç”¨ä»–çš„æ¨¡å—æ‰‹å†Œæä¾›çš„æ»¤æ³¢å‡½æ•°å¯¹æ•°æ®è¿›è¡Œæ»¤æ³¢ä¹‹åå†å‡å»imuè¡¥å¿é‡, å¾—åˆ°è¡¥å¿åçš„é€Ÿåº¦. [5]ä¸­æ˜¯å…ˆè·å–é€Ÿåº¦ç„¶åç§¯åˆ†æˆä½ç§», å†ç”¨ä½ç§»å‡å»è¡¥å¿é‡ç„¶åå†å¾®åˆ†æˆé€Ÿåº¦.(è¿™ä¹ˆåšä¸»è¦è€ƒè™‘åˆ°é€Ÿåº¦ä¸å¥½æ ‡å®š, ä½†ä½ç§»ç›¸å¯¹æ¥è¯´æ›´å®¹æ˜“å¾—åˆ°æµ‹é‡å€¼ç”¨äºçŸ«æ­£å‚æ•°çš„èµ‹å€¼)\nç›®å‰ä½¿ç”¨çš„MTF-01å…‰æµä¼ æ„Ÿå™¨åªæä¾›äº†è¯»å–å…‰æµé€Ÿåº¦çš„ç›¸å…³å‡½æ•°, å¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 // mtf01.h #pragma once #include \u0026lt;stdbool.h\u0026gt; #include \u0026lt;stdint.h\u0026gt; #include \u0026lt;string.h\u0026gt; #define MICOLINK_MSG_HEAD 0xEF #define MICOLINK_MAX_PAYLOAD_LEN 64 #define MICOLINK_MAX_LEN MICOLINK_MAX_PAYLOAD_LEN + 7 /* æ¶ˆæ¯IDå®šä¹‰ */ enum { MICOLINK_MSG_ID_RANGE_SENSOR = 0x51, // æµ‹è·ä¼ æ„Ÿå™¨ }; /* æ¶ˆæ¯ç»“æ„ä½“å®šä¹‰ */ typedef struct { uint8_t head; uint8_t dev_id; uint8_t sys_id; uint8_t msg_id; uint8_t seq; uint8_t len; uint8_t payload[MICOLINK_MAX_PAYLOAD_LEN]; uint8_t checksum; uint8_t status; uint8_t payload_cnt; } MICOLINK_MSG_t; /* æ•°æ®è´Ÿè½½å®šä¹‰ */ #pragma pack(1) // æµ‹è·ä¼ æ„Ÿå™¨ typedef struct { uint32_t time_ms; // ç³»ç»Ÿæ—¶é—´ ms uint32_t distance; // è·ç¦»(mm) æœ€å°å€¼ä¸º10ï¼Œ0è¡¨ç¤ºæ•°æ®ä¸å¯ç”¨ uint8_t strength; // ä¿¡å·å¼ºåº¦ uint8_t precision; // ç²¾åº¦ uint8_t tof_status; // çŠ¶æ€ uint8_t reserved1; // é¢„ç•™ int16_t flow_vel_x; // å…‰æµé€Ÿåº¦xè½´ int16_t flow_vel_y; // å…‰æµé€Ÿåº¦yè½´ uint8_t flow_quality; // å…‰æµè´¨é‡ uint8_t flow_status; // å…‰æµçŠ¶æ€ uint16_t reserved2; // é¢„ç•™ } MICOLINK_PAYLOAD_RANGE_SENSOR_t; #pragma pack() 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 // mtf01.c #include \u0026#34;mtf01.h\u0026#34; /* è¯´æ˜ï¼š ç”¨æˆ·ä½¿ç”¨micolink_decodeä½œä¸ºä¸²å£æ•°æ®å¤„ç†å‡½æ•°å³å¯ è·ç¦»æœ‰æ•ˆå€¼æœ€å°ä¸º10(mm),ä¸º0è¯´æ˜æ­¤æ—¶è·ç¦»å€¼ä¸å¯ç”¨ å…‰æµé€Ÿåº¦å€¼å•ä½ï¼šcm/s@1m é£æ§ä¸­åªéœ€è¦å°†å…‰æµé€Ÿåº¦å€¼*é«˜åº¦ï¼Œå³å¯å¾—åˆ°çœŸå®æ°´å¹³ä½ç§»é€Ÿåº¦ è®¡ç®—å…¬å¼ï¼šå®é™…é€Ÿåº¦(cm/s)=å…‰æµé€Ÿåº¦*é«˜åº¦(m) */ bool micolink_parse_char(MICOLINK_MSG_t *msg, uint8_t data); void micolink_decode(uint8_t data) { static MICOLINK_MSG_t msg; if (micolink_parse_char(\u0026amp;msg, data) == false) return; switch (msg.msg_id) { case MICOLINK_MSG_ID_RANGE_SENSOR: { MICOLINK_PAYLOAD_RANGE_SENSOR_t payload; memcpy(\u0026amp;payload, msg.payload, msg.len); /* æ­¤å¤„å¯è·å–ä¼ æ„Ÿå™¨æ•°æ®: è·ç¦» = payload.distance; å¼ºåº¦ = payload.strength; ç²¾åº¦ = payload.precision; è·ç¦»çŠ¶æ€ = payload.tof_status; å…‰æµé€Ÿåº¦xè½´ = payload.flow_vel_x; å…‰æµé€Ÿåº¦yè½´ = payload.flow_vel_y; å…‰æµè´¨é‡ = payload.flow_quality; å…‰æµçŠ¶æ€ = payload.flow_status; */ break; } default: break; } } bool micolink_check_sum(MICOLINK_MSG_t *msg) { uint8_t length = msg-\u0026gt;len + 6; uint8_t temp[MICOLINK_MAX_LEN]; uint8_t checksum = 0; memcpy(temp, msg, length); for (uint8_t i = 0; i \u0026lt; length; i++) { checksum += temp[i]; } if (checksum == msg-\u0026gt;checksum) return true; else return false; } bool micolink_parse_char(MICOLINK_MSG_t *msg, uint8_t data) { switch (msg-\u0026gt;status) { case 0: // å¸§å¤´ if (data == MICOLINK_MSG_HEAD) { msg-\u0026gt;head = data; msg-\u0026gt;status++; } break; case 1: // è®¾å¤‡ID msg-\u0026gt;dev_id = data; msg-\u0026gt;status++; break; case 2: // ç³»ç»ŸID msg-\u0026gt;sys_id = data; msg-\u0026gt;status++; break; case 3: // æ¶ˆæ¯ID msg-\u0026gt;msg_id = data; msg-\u0026gt;status++; break; case 4: // åŒ…åºåˆ— msg-\u0026gt;seq = data; msg-\u0026gt;status++; break; case 5: // è´Ÿè½½é•¿åº¦ msg-\u0026gt;len = data; if (msg-\u0026gt;len == 0) msg-\u0026gt;status += 2; else if (msg-\u0026gt;len \u0026gt; MICOLINK_MAX_PAYLOAD_LEN) msg-\u0026gt;status = 0; else msg-\u0026gt;status++; break; case 6: // æ•°æ®è´Ÿè½½æ¥æ”¶ msg-\u0026gt;payload[msg-\u0026gt;payload_cnt++] = data; if (msg-\u0026gt;payload_cnt == msg-\u0026gt;len) { msg-\u0026gt;payload_cnt = 0; msg-\u0026gt;status++; } break; case 7: // å¸§æ ¡éªŒ msg-\u0026gt;checksum = data; msg-\u0026gt;status = 0; if (micolink_check_sum(msg)) { return true; } default: msg-\u0026gt;status = 0; msg-\u0026gt;payload_cnt = 0; break; } return false; } æ¨æµ‹è¯»å–å…‰æµé€Ÿåº¦åç›´æ¥å‡å»é™€èºä»ªè·å–çš„é€Ÿåº¦ç„¶åèµ‹ç»™ek3è¿›è¡Œåç»­çš„æ•°æ®èåˆå³å¯\nArdupilotå®˜æ–¹æ–‡æ¡£ä¸­çš„æ ¡å‡†ä¼ æ„Ÿå™¨ è§å‚è€ƒèµ„æ–™[6], åœ¨æ–‡æ¡£ä¸­å‘ç°ä¸€å‡ºæ ¡å‡†å…‰æµä¼ æ„Ÿå™¨çš„æ“ä½œ, å…¶ä¸­æåˆ°FLOW_FXSCALER, FLOW_FYSCALERä¸¤ä¸ªå‚æ•°ç”¨äºæŠŠå…‰æµé€Ÿåº¦ä¸imué€Ÿåº¦è°ƒæ•´åˆ°ç›¸è¿‘æ³¢å½¢, å°šæœªç»è¿‡æµ‹è¯•è¿™ä¸ªå‚æ•°çš„ç”¨å¤„\nå‚è€ƒèµ„æ–™ [1] å…‰æµå®šç‚¹è‹¥å¹²é—®é¢˜åˆ†æ_æƒç››å…‰æµ æ— æ³•å®šé«˜_engineerlixlçš„åšå®¢-CSDNåšå®¢\n[2] Ardupilotå…‰æµä»£ç åˆ†æ - CodeAntenna\n[3] PX4FLOWå…‰æµæ¨¡å—DIYï¼ˆå«éƒ¨åˆ†ä»£ç è®²è§£ï¼‰_xian_zçš„åšå®¢-CSDNåšå®¢\n[4] æ— äººæœºâ€”åŠ é€Ÿåº¦è®¡ä¸å…‰æµæ•°æ®èåˆ_å…‰æµèåˆ_ç»çº¬çš„æ— ç–†çš„åšå®¢-CSDNåšå®¢\n[5] æ— äººæœºé£æ§ä¹‹å…‰æµçŸ¥è¯†å°ç»“ï¼ˆåŒ…å«LKç®—æ³•çš„è®²è§£ï¼Œacrosså†™çš„ï¼‰ | ç å†œå®¶å›­ (codenong.com)\n[6] Optical Flow Sensor Testing and Setup â€” Copter documentation (ardupilot.org)\n","date":"2023-04-28T02:02:45+08:00","image":"https://raw.githubusercontent.com/TioeAre/imageHost/main/pictures/85626613_p0_master1200.jpg","permalink":"https://www.blog.tioe.xyz/daily/2023.04.28/","title":"imuè¡¥å¿å…‰æµ"},{"content":"RealSense D455çš„æ ‡å®š imuè‡ªæ ¡å‡† intelå‘å¸ƒçš„d455æ·±åº¦ç›¸æœºè‡ªå¸¦çš„æœ‰ä¸€ä¸ªimuï¼Œåœ¨å¯¹ç›¸æœºè¿›è¡Œæ ‡å®šä¹‹å‰é¦–å…ˆè¦æ ¡å‡†ä¸€ä¸‹imu\næ ¡å‡†æ“ä½œè§å®˜æ–¹æ–‡æ¡£ï¼Œå®˜æ–¹æä¾›æœ‰pythonè„šæœ¬ç”¨äºè‡ªåŠ¨åŒ–æ ¡å‡†ï¼Œpdfä¸­å¯¹å…·ä½“æ“ä½œæœ‰æ˜ç¡®è¡¨è¿°ã€‚è¿™é‡Œæåˆ°ä¸€ç‚¹æ“ä½œæ—¶çš„ä¸€ä¸ªbug\næ­£å¸¸æƒ…å†µä¸‹æ‰§è¡Œæ ¡å‡†ç¨‹åºè¾“å‡ºåº”å½“ç±»ä¼¼äº\nåªè¦æŒ‰ç…§pdfä¸­ç¤ºä¾‹çš„æ–¹å¼æ‘†æ”¾ç›¸æœºï¼Œå½“ä¸‰è½´è§’åº¦éƒ½ä¸ºtrueçš„æ—¶å€™å°±ä¼šè‡ªåŠ¨æ”¶é›†æ•°æ®ï¼Œä½†æ˜¯æˆ‘æœ€å¼€å§‹é‡åˆ°äº†\nä¸€ç›´åœç•™åœ¨Status.rotateçŠ¶æ€ï¼Œæ— è®ºæ€ä¹ˆè½¬éƒ½æ— æ³•ç¨³å®šåœ¨collectä¸­ï¼Œç„¶ååœ¨githubçš„issueä¸­å‘ç°äº†ç›¸ä¼¼é—®é¢˜\nè§£å†³æ–¹æ³•ï¼š\nä¿®æ”¹rs-imu-calibration.pyç¬¬100è¡Œä¸616è¡Œï¼ŒèŒƒå›´æ”¹å¤§ä¸€äº›åˆ°0.6å°±å¯ä»¥äº†\n1 2 3 self.max_norm = np.linalg.norm(np.array([0.6, 0.6, 0.6])) max_norm = np.linalg.norm(np.array([0.6, 0.6, 0.6])) å‚è€ƒé“¾æ¥:https://github.com/IntelRealSense/librealsense/issues/10418#issuecomment-1103125414\næ‰“å¼€realsense-viewerå¯ä»¥å‘ç°æ ¡å‡†åç«–ç›´æ‘†æ”¾ç›¸æœºï¼Œé‡åŠ›åŠ é€Ÿåº¦è¿‘ä¼¼äº9.8ï¼Œè€Œæ ¡å‡†å‰æ˜¾ç¤ºä¸º8.8ï¼Œè¯´æ˜æ ¡å‡†èµ·åˆ°æ•ˆæœ\nè”åˆæ ‡å®š å‡ºç°äº†ä»¥ä¸‹bugï¼Œéœ€è¦sudo apt install libelf-dev\n1 2 3 /home/username/packages/realsense_imu_catkin_ws/src/code_utils/include/code_utils/backward.hpp:216:25: fatal error: elfutils/libdw.h: No such file or directory 216 | # include \u0026lt;elfutils/libdw.h\u0026gt; | ^~~~~~~~~~~~~~~~~~ ä½†æ˜¯å®‰è£…çš„æ—¶å€™aptæŠ¥é”™\n1 2 3 4 5 6 7 8 9 10 Some packages could not be installed. This may mean that you have requested an impossible situation or if you are using the unstable distribution that some required packages have not yet been created or been moved out of Incoming. The following information may help to resolve the situation: The following packages have unmet dependencies. libdw-dev : Depends: libelf-dev but it is not going to be installed Depends: libdw1 (= 0.165-3ubuntu1.2) but 0.176-1.1build1 is to be installed E: Unable to correct problems, you have held broken packages. ä¸‹è½½æœ€æ–°çš„å®‰è£…åŒ…æ‰‹åŠ¨å®‰è£…\nhttp://archive.ubuntu.com/ubuntu/pool/main/e/elfutils/libelf-dev_0.176-1.1build1_amd64.deb\nhttp://archive.ubuntu.com/ubuntu/pool/main/e/elfutils/libdw-dev_0.176-1.1build1_amd64.deb\n1 2 3 4 /home/username/packages/realsense_imu_catkin_ws/src/code_utils/src/sumpixel_test.cpp:2:10: fatal error: backward.hpp: No such file or directory 2 | #include \u0026#34;backward.hpp\u0026#34; | ^~~~~~~~~~~~~~ compilation terminated. ä¿®æ”¹sumpixel_test.cppç¬¬2è¡Œä¸º`#include \u0026ldquo;code_utils/backward.hpp\u0026rdquo;\n1 error: â€˜integer_sequenceâ€™ is not a member of â€˜stdâ€™ 75 | std::integer_sequence\u0026lt;T, N, Ns...\u0026gt; ä¿®æ”¹CMakests.txt\n1 set(CMAKE_CXX_STANDARD 14) 1 2 3 /home/username/packages/realsense_imu_catkin_ws/src/code_utils/src/mat_io_test.cpp:33:47: error: â€˜CV_LOAD_IMAGE_UNCHANGEDâ€™ was not declared in this scope 33 | Mat img1 = imread( \u0026#34;/home/gao/IMG_1.png\u0026#34;, CV_LOAD_IMAGE_UNCHANGED ); | ^~~~~~~~~~~~~~~~~~~~~~~ opencvç‰ˆæœ¬å®å®šä¹‰é—®é¢˜ï¼Œæ”¹ç›¸å…³ä»£ç ä¸ºæ–°ç‰ˆçš„å°±è¡Œ\nhttps://blog.csdn.net/weixin_44675820/article/details/124796674\nhttps://www.cnblogs.com/zzzsj/p/15699524.html\n1 /home/tioeare/packages/realsense_imu_catkin_ws/src/imu_utils/src/imu_an.cpp:68:19: error: aggregate â€˜std::ofstream out_tâ€™ has incomplete type and cannot be defined ä¿®æ”¹imu_an.cppï¼Œæ·»åŠ #include \u0026lt;fstream\u0026gt;\n1 2 3 4 5 6 7 Errors \u0026lt;\u0026lt; aslam_time:make /home/tioeare/packages/kalibr_workspace/logs/aslam_time/build.make.000.log /home/tioeare/packages/kalibr_workspace/src/kalibr/aslam_cv/aslam_time/src/time.cpp:84:25: error: ISO C++17 does not allow dynamic exception specifications 84 | throw (NoHighPerformanceTimersException) | ^~~~~ make[2]: *** [CMakeFiles/aslam_time.dir/build.make:76: CMakeFiles/aslam_time.dir/src/time.cpp.o] Error 1 make[1]: *** [CMakeFiles/Makefile2:295: CMakeFiles/aslam_time.dir/all] Error 2 make: *** [Makefile:146: all] Error 2 æŠŠä»£ç é‡Œè¿™ä¸€è¡Œæ³¨é‡Šæ‰ï¼Œå¾ˆå¥‡æ€ªï¼Œè¿™ç§ç”¨æ³•åº”è¯¥C++11å°±ç¦æ­¢äº†ï¼Œgithubä¸Šä¹Ÿæ²¡äººæ\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 gyr x numData 240384 gyr x start_t 1.6799e+09 gyr x end_t 1.6799e+09 gyr x dt -------------600.003 s -------------10 min -------------0.166667 h gyr x freq 400.636 gyr x period 0.00249603 gyr y numData 240384 gyr y start_t 1.6799e+09 gyr y end_t 1.6799e+09 gyr y dt -------------600.003 s -------------10 min -------------0.166667 h gyr y freq 400.636 gyr y period 0.00249603 gyr z numData 240384 gyr z start_t 1.6799e+09 gyr z end_t 1.6799e+09 gyr z dt -------------600.003 s -------------10 min -------------0.166667 h gyr z freq 400.636 gyr z period 0.00249603 Gyro X C -2.40087 59.1038 -17.8144 3.38392 -0.0618206 Bias Instability 3.00267e-05 rad/s Bias Instability 5.92447e-05 rad/s, at 26.0036 s White Noise 16.8009 rad/s White Noise 0.00479981 rad/s bias 0.0580428 degree/s ------------------- Gyro y C -3.7193 89.2566 -24.0407 4.84558 -0.260302 Bias Instability 2.69712e-06 rad/s Bias Instability 9.61604e-05 rad/s, at 22 s White Noise 26.42 rad/s White Noise 0.00733927 rad/s bias -0.304682 degree/s ------------------- Gyro z C -1.0341 30.2021 -13.4864 3.95908 -0.244715 Bias Instability 4.5525e-06 rad/s Bias Instability 1.78885e-05 rad/s, at 56.7372 s White Noise 7.71113 rad/s White Noise 0.00214285 rad/s bias -0.095305 degree/s ------------------- ============================================== ============================================== acc x numData 240384 acc x start_t 1.6799e+09 acc x end_t 1.6799e+09 acc x dt -------------600.003 s -------------10 min -------------0.166667 h acc x freq 400.636 acc x period 0.00249603 acc y numData 240384 acc y start_t 1.6799e+09 acc y end_t 1.6799e+09 acc y dt -------------600.003 s -------------10 min -------------0.166667 h acc y freq 400.636 acc y period 0.00249603 acc z numData 240384 acc z start_t 1.6799e+09 acc z end_t 1.6799e+09 acc z dt -------------600.003 s -------------10 min -------------0.166667 h acc z freq 400.636 acc z period 0.00249603 acc X C -3.7565e-05 0.00153459 -0.000440891 5.14013e-05 1.36731e-05 Bias Instability 0.000415133 m/s^2 White Noise 0.0229567 m/s^2 ------------------- acc y C -0.000153981 0.00273578 0.000838508 -0.000456266 4.36107e-05 Bias Instability 0.000674808 m/s^2 White Noise 0.0392674 m/s^2 ------------------- acc z C -4.04458e-05 0.00242156 -0.00204122 0.000559034 -3.01212e-05 Bias Instability 0.000795269 m/s^2 White Noise 0.0348949 m/s^2 ------------------- [imu_an-1] process has finished cleanly 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 Traceback (most recent call last): File \u0026#34;build/kalibr/atomic_configure/kalibr_calibrate_cameras\u0026#34;, line 15, in \u0026lt;module\u0026gt; exec(compile(fh.read(), python_script, \u0026#39;exec\u0026#39;), context) File \u0026#34;/home/tioeare/packages/kalibr_workspace/src/kalibr/aslam_offline_calibration/kalibr/python/kalibr_calibrate_cameras\u0026#34;, line 465, in \u0026lt;module\u0026gt; main() File \u0026#34;/home/tioeare/packages/kalibr_workspace/src/kalibr/aslam_offline_calibration/kalibr/python/kalibr_calibrate_cameras\u0026#34;, line 175, in main cam = kcc.CameraGeometry(cameraModel, targetConfig, dataset, verbose=(parsed.verbose or parsed.showextraction)) File \u0026#34;/home/tioeare/packages/kalibr_workspace/src/kalibr/aslam_offline_calibration/kalibr/python/kalibr_camera_calibration/CameraCalibrator.py\u0026#34;, line 48, in __init__ self.ctarget = TargetDetector(targetConfig, self.geometry, showCorners=verbose) File \u0026#34;/home/tioeare/packages/kalibr_workspace/src/kalibr/aslam_offline_calibration/kalibr/python/kalibr_camera_calibration/CameraCalibrator.py\u0026#34;, line 81, in __init__ targetParams = targetConfig.getTargetParams() File \u0026#34;/home/tioeare/packages/kalibr_workspace/src/kalibr/aslam_offline_calibration/kalibr/python/kalibr_common/ConfigReader.py\u0026#34;, line 187, in func return f(*args, **kwargs) File \u0026#34;/home/tioeare/packages/kalibr_workspace/src/kalibr/aslam_offline_calibration/kalibr/python/kalibr_common/ConfigReader.py\u0026#34;, line 620, in getTargetParams errList.append(\u0026#34;invalid tagSpacing (float)\u0026#34;) NameError: name \u0026#39;errList\u0026#39; is not defined ç›¸åº”ä½ç½®çš„æ–‡ä»¶ä¸­errListå…¨éƒ¨æ¢æˆé€”ä¸­çš„printè¯­å¥\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 Traceback (most recent call last): File \u0026#34;build/kalibr/atomic_configure/kalibr_calibrate_imu_camera\u0026#34;, line 15, in \u0026lt;module\u0026gt; exec(compile(fh.read(), python_script, \u0026#39;exec\u0026#39;), context) File \u0026#34;/home/tioeare/packages/kalibr_workspace/src/kalibr/aslam_offline_calibration/kalibr/python/kalibr_calibrate_imu_camera\u0026#34;, line 247, in \u0026lt;module\u0026gt; main() File \u0026#34;/home/tioeare/packages/kalibr_workspace/src/kalibr/aslam_offline_calibration/kalibr/python/kalibr_calibrate_imu_camera\u0026#34;, line 173, in main chain.printDetails() File \u0026#34;/home/tioeare/packages/kalibr_workspace/src/kalibr/aslam_offline_calibration/kalibr/python/kalibr_common/ConfigReader.py\u0026#34;, line 765, in printDetails camConfig.printDetails(dest) File \u0026#34;/home/tioeare/packages/kalibr_workspace/src/kalibr/aslam_offline_calibration/kalibr/python/kalibr_common/ConfigReader.py\u0026#34;, line 387, in printDetails dist_model, dist_coeff = self.getDistortion() File \u0026#34;/home/tioeare/packages/kalibr_workspace/src/kalibr/aslam_offline_calibration/kalibr/python/kalibr_common/ConfigReader.py\u0026#34;, line 187, in func return f(*args, **kwargs) File \u0026#34;/home/tioeare/packages/kalibr_workspace/src/kalibr/aslam_offline_calibration/kalibr/python/kalibr_common/ConfigReader.py\u0026#34;, line 355, in getDistortion self.checkDistortion(self.data[\u0026#34;distortion_model\u0026#34;], File \u0026#34;/home/tioeare/packages/kalibr_workspace/src/kalibr/aslam_offline_calibration/kalibr/python/kalibr_common/ConfigReader.py\u0026#34;, line 350, in checkDistortion self.raiseError(\u0026#34;distortion model \u0026#39;{}\u0026#39; requires {} coefficients; {} given\u0026#34;.format( File \u0026#34;/home/tioeare/packages/kalibr_workspace/src/kalibr/aslam_offline_calibration/kalibr/python/kalibr_common/ConfigReader.py\u0026#34;, line 235, in raiseError raise RuntimeError( \u0026#34;{0}{1}\u0026#34;.format(header, message) ) RuntimeError: [CameraConfig Reader]: distortion model \u0026#39;radtan\u0026#39; requires 4 coefficients; 1 given chain.yamlåŠ é€—å·\n1 2 3 4 5 pcl::transformPointCloud(*cloud_voxel_tem, *cloud1, T.matrix()); //æŠ¥é”™ Signal: SIGSEGV (Segmentation fault) [pcl::VoxelGrid::applyFilter] Leaf size is too small for the input dataset. Integer indices would overflow. Assignment with new_width equal to 0,setting width to size of the cloud and height to 1 ","date":"2023-03-26T02:02:45+05:00","image":"https://raw.githubusercontent.com/TioeAre/imageHost/main/pictures/102368197_p0_master1200.jpg","permalink":"https://www.blog.tioe.xyz/daily/2023.03.26/","title":"D455æ ‡å®šä¸pclç‚¹äº‘åº“çš„å­¦ä¹ "},{"content":"å‘¨ä¸€è‡³å‘¨ä¸‰ ç”±äºäº¤ä»˜æ—¶é—´æœ‰ç‚¹ç´§ï¼Œç”Ÿäº§çš„åŒäº‹ä¸»è¦åœ¨åšäº¤ä»˜åˆ°è¥¿è—çš„å¤§å‹æ— äººæœºï¼Œç„¶åæˆ‘å°±å»å¸®å¿™è£…é…å°æ— äººæœº\nå‘¨ä¸‰åˆ°å‘¨äº” ç»§ç»­æˆ‘çš„ç®—æ³•éƒ¨åˆ†ï¼Œè¿™ä¸¤å¤©å…ˆè·‘é€šäº†orb-slam3ï¼ŒORB-SLAMæ˜¯è¥¿ç­ç‰™ Zaragoza å¤§å­¦çš„ RaÃºl Mur-Arta ç¼–å†™çš„è§†è§‰ SLAM ç³»ç»Ÿã€‚ å®ƒæ˜¯ä¸€ä¸ªå®Œæ•´çš„ SLAM ç³»ç»Ÿï¼ŒåŒ…æ‹¬è§†è§‰é‡Œç¨‹è®¡ã€è·Ÿè¸ªã€å›ç¯æ£€æµ‹ï¼Œæ˜¯ä¸€ç§å®Œå…¨åŸºäºç¨€ç–ç‰¹å¾ç‚¹çš„å•ç›® SLAM ç³»ç»Ÿï¼ŒåŒæ—¶è¿˜æœ‰å•ç›®ã€åŒç›®ã€RGBD ç›¸æœºçš„æ¥å£ã€‚æ ¸å¿ƒæ˜¯ä½¿ç”¨ ORB (Orinted FAST and BRIEF) ä½œä¸ºæ•´ä¸ªè§†è§‰ SLAM ä¸­çš„æ ¸å¿ƒç‰¹å¾ã€‚\nè¿™å‘¨é¦–å…ˆåœ¨æˆ‘çš„ç”µè„‘ä¸Šè·‘é€šäº†20å¹´å‘å¸ƒçš„orb-slam3ã€‚\næ•ˆæœå¦‚ä¸‹:\nå›¾ä¸­å·¦ä¾§çª—å£ä¸ºæ„å»ºçš„ç¨€ç–åœ°å›¾ï¼Œè“è‰²è¡¨ç¤ºç›¸æœºä½å§¿ï¼Œæ•£ç‚¹ä¸ºæå–çš„orbç‰¹å¾ç‚¹ï¼Œå³ä¾§çª—å£ä¸ºåŒç›®çº¢å¤–ç›¸æœºå®æ—¶æ‹æ‘„åˆ°çš„å›¾åƒï¼Œç»¿è‰²ç‚¹ä¸ºå›¾åƒä¸­çš„æ£€æµ‹åˆ°çš„ç‰¹å¾ç‚¹\nè¿è¡Œæ­¥éª¤ ä¸»è¦è¿è¡Œç¯å¢ƒä¸ºubuntu20.04ç³»ç»Ÿï¼ŒROSç‰ˆæœ¬ä¸ºnoeticï¼ŒOpenCVç‰ˆæœ¬4.5.5ï¼Œeigenç‰ˆæœ¬3.4.0\nåœ¨è¿è¡Œè¿‡ç¨‹ä¸­ä¸»è¦å®˜æ–¹æ–‡æ¡£ï¼Œå…¶ä¸­ä¸»è¦é‡åˆ°äº†ä¸¤ä¸ªbugï¼Œå¦‚ä¸‹\nopencvç‰ˆæœ¬é—®é¢˜ åœ¨è¿è¡ŒROSçš„å®ä¾‹ä¸­ï¼Œç”±äºå®‰è£…æ—¶ROS noeticè‡ªå¸¦çš„æœ‰4.2.0çš„OpenCVï¼Œcv_bridgeä¹Ÿæ˜¯4.2çš„ï¼Œå¯¼è‡´ä¼šå‡ºç°å¦‚ä¸‹é”™è¯¯\n1 2 \u0026#39;cv::Exception\u0026#39; what(): OpenCV(4.5.5) /home/ubuntu/Downloads/opencv-4.5.5/opencv/modules/core/src/matrix.cpp:250: error: (-215:Assertion failed) s \u0026gt;= 0 in function \u0026#39;setSize\u0026#39;` \u0026#39;cv::Exception\u0026#39; what(): OpenCV(4.5.5) /home/ubuntu/Downloads/opencv-4.5.5/opencv/modules/core/src/alloc.cpp:73: error: (-4:Insufficient memory) Failed to allocate 87219830269440 bytes in function \u0026#39;OutOfMemoryError éœ€è¦è‡ªå·±å†ä¸‹è½½ä¸€ä¸ªcv_bridgeçš„æºç ï¼Œç„¶åç¼–è¯‘å‡ºæœ¬æœº4.5.5ç‰ˆæœ¬çš„cv_bridgeï¼Œéšååœ¨orbslam3çš„CMakeLists.txtä¸­ä¿®æ”¹å¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 set(cv_bridge_DIR \u0026#34;/home/username/path_to_cvbridge_build_ws/devel/share/cv_bridge/cmake\u0026#34;) set(OpenCV_DIR /usr/local/share/opencv4) LIST(APPEND CMAKE_MODULE_PATH ${PROJECT_SOURCE_DIR}/cmake_modules) find_package(OpenCV 4.5.5 REQUIRED) if(NOT OpenCV_FOUND) message(FATAL_ERROR \u0026#34;OpenCV \u0026gt; 4.4 not found.\u0026#34;) endif() MESSAGE(\u0026#34;OPENCV VERSION:\u0026#34;) MESSAGE(${OpenCV_VERSION}) c++ç‰ˆæœ¬é—®é¢˜ åŸç‰ˆé»˜è®¤çš„c++ä¸ºc++11ç‰ˆæœ¬ï¼Œä½†å®æ“å‘ç°ç¼–è¯‘æ— æ³•é€šè¿‡ï¼Œéœ€è¦ä¿®æ”¹ä¸ºc++14ï¼Œä¿®æ”¹å¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 # Check C++11 or C++0x support include(CheckCXXCompilerFlag) CHECK_CXX_COMPILER_FLAG(\u0026#34;-std=c++14\u0026#34; COMPILER_SUPPORTS_CXX11) CHECK_CXX_COMPILER_FLAG(\u0026#34;-std=c++0x\u0026#34; COMPILER_SUPPORTS_CXX0X) if(COMPILER_SUPPORTS_CXX14) set(CMAKE_CXX_FLAGS \u0026#34;${CMAKE_CXX_FLAGS} -std=c++14\u0026#34;) add_definitions(-DCOMPILEDWITHC11) message(STATUS \u0026#34;Using flag -std=c++14.\u0026#34;) elseif(COMPILER_SUPPORTS_CXX0X) set(CMAKE_CXX_FLAGS \u0026#34;${CMAKE_CXX_FLAGS} -std=c++0x\u0026#34;) add_definitions(-DCOMPILEDWITHC0X) message(STATUS \u0026#34;Using flag -std=c++0x.\u0026#34;) else() message(FATAL_ERROR \u0026#34;The compiler ${CMAKE_CXX_COMPILER} has no C++11 support. Please use a different C++ compiler.\u0026#34;) endif() #æ·»åŠ c++14æ ‡å‡† eigen3 1 2 3 4 5 6 7 8 9 CMake Error at CMakeLists.txt:44 (find_package): Found package configuration file: /usr/local/lib/cmake/Pangolin/PangolinConfig.cmake but it set Pangolin_FOUND to FALSE so package \u0026#34;Pangolin\u0026#34; is considered to be NOT FOUND. Reason given by package: Pangolin could not be found because dependency Eigen3 could not be found. cmakelists.txtä¸­eigenéƒ¨åˆ†æ¢ä¸º\n1 FIND_PACKAGE(Eigen3 REQUIRED NO_MODULE) intel realsense d455ç›¸å…³è®¾ç½® éœ€è¦å°†çº¢å¤–ç›¸æœºçš„çº¢å¤–å‘å°„å™¨å…³æ‰ï¼Œå¦åˆ™ä¼šæå¤§å½±å“ç‰¹å¾çš„æå–\n1 stereo_module emitter_enabled éœ€è¦å°†lanuchæ–‡ä»¶ä¸­è¿™ä¸¤é¡¹è®¾ä¸ºfalse\nä¸‹ä¸€å‘¨è®¡åˆ’ ç›®å‰çš„ç®—æ³•ä¸­åªèƒ½å»ºç«‹èµ·ç¨€ç–åœ°å›¾ç”¨äºè‡ªèº«çš„å®šä½ï¼Œä¸‹ä¸€æ­¥éœ€è¦å€ŸåŠ©pclåº“å’Œæ·±åº¦ç›¸æœºå»ºç«‹èµ·ç¨ å¯†ç‚¹äº‘åœ°å›¾æ¥å®ç°é¿éšœå’Œå¯¼èˆªåŠŸèƒ½\n","date":"2023-03-26T02:02:45+08:00","image":"https://raw.githubusercontent.com/TioeAre/imageHost/main/pictures/100285476_p0_master1200.jpg","permalink":"https://www.blog.tioe.xyz/daily/2023.03.23/","title":"è£…é…å¹¶å­¦ä¹ ç‚¹äº‘åº“"},{"content":"Caddy v2, webhook, hugoæ­å»ºåšå®¢å¹¶é…ç½®bitwardenä¸v2ray é¡¹ç›®æ¦‚è¿° ç‰ˆæœ¬è¯´æ˜ caddy ä¹‹å‰æˆ‘çš„æœåŠ¡å™¨(amd64, debain10)ä¸Šä¸€ç›´ç”¨çš„æ˜¯caddy 1.xç‰ˆæœ¬, ç›®å‰å®˜æ–¹ä¸ºäº†æ¨å¹¿2.0ç‰ˆæœ¬, å·²ç»ç»æƒ…çš„å°†v1ç‰ˆæœ¬çš„å®˜æ–¹ä¸‹è½½æ¸ é“, æ’ä»¶å®‰è£…è„šæœ¬ä»¥åŠæ–‡æ¡£ç­‰å…¨éƒ½åˆ æ‰äº†ğŸ™ƒ, å¯¼è‡´æˆ‘æœ€å¼€å§‹çœ‹çš„å…³äºv1ç‰ˆæ­å»ºåšå®¢çš„æ•™ç¨‹å…¨éƒ½ç”¨ä¸äº†. å¹¶ä¸”ç”±äºv1ç‰ˆå·²ç»å‘å¸ƒå¾ˆå¤šå¹´äº†, è€Œv2åœ¨2020å¹´æ‰å‘å¸ƒ. ç½‘ä¸Šç»å¤§éƒ¨åˆ†æ•™ç¨‹ä»¥åŠgit, webhookç›¸å…³çš„æ’ä»¶è¿˜éƒ½æ˜¯v1ç‰ˆçš„, å¯¹çº¯èŒæ–°æ¥è¯´æŒºéš¾æ‰¾åˆ°åˆé€‚çš„æ•™ç¨‹æ¥è¯¦ç»†æè¿°å…·ä½“å¦‚ä½•é…ç½®. ç›®å‰ç½‘ä¸Šä¹Ÿæœ‰äº†å¾ˆå¤šå¤§ä½¬å¼€æºçš„åŒ…å«æœ‰caddy v2, hugoç­‰çš„dockeré•œåƒå¯ä»¥æ–¹ä¾¿çš„ä¸€é”®æ­å»ºåšå®¢. ä½†ä¸çŸ¥é“ä¸ºä»€ä¹ˆåœ¨æˆ‘çš„æœåŠ¡å™¨ä¸Šè¿è¡Œæ—¶ä¼¼ä¹æ²¡æœ‰åŠæ³•æ­£å¸¸ç›‘å¬ç«¯å£ä¸€æ ·ï¼Œæ€»æ˜¯æ¥å—ä¸åˆ°ç›¸å…³çš„è¯·æ±‚\næ­¤å¤–, caddy v2ä¸v1ç›¸æ¯”é…ç½®æ–‡ä»¶æ”¹æˆäº†åŸç”Ÿjsonæ ¼å¼, ä¹‹å‰v1ç‰ˆæœ¬çš„æ—¶å€™ä½¿ç”¨çš„é…ç½®æ–‡ä»¶æ˜¯Caddyfile, å†™èµ·æ¥å³ç®€ä¾¿åˆæ˜“è¯». ç°åœ¨æ¢æˆjsonä¹‹å, è™½ç„¶è¿˜æ˜¯å¯ä»¥ç”¨Caddyfileæ¥å†™, ä½†æ˜¯å®é™…è¿è¡Œcaddyä¼¼ä¹ä¼šå…ˆå°†Caddyfileè½¬åŒ–æˆjsonç„¶åå†è¿è¡Œ. è¿™å°±å¯¼è‡´å†™åœ¨Caddyfileé‡Œçš„é…ç½®, å°¤å…¶æ˜¯ç›¸å…³æ’ä»¶çš„é…ç½®å¾ˆå¯èƒ½åœ¨è½¬åŒ–çš„æ—¶å€™å‡ºç°æŸäº›é—®é¢˜å¯¼è‡´è¿è¡Œå¤±è´¥. è¿˜æœ‰å¦å¤–ä¸€ä¸ªå¾ˆé‡è¦çš„é—®é¢˜æ˜¯, å¤§å¤šv2ç‰ˆæœ¬çš„caddyæ’ä»¶æ˜¯æ”¯æŒCaddyfileçš„å†™æ³•çš„, ä½†æœ‰äº›æ’ä»¶å°±åªæœ‰jsonæ ¼å¼çš„é…ç½®å†™æ³•. è€Œå‰é¢ä¹Ÿæåˆ°Caddyfileæ˜¯å¯ä»¥è¢«caddyè½¬åŒ–ä¸ºjsonæ ¼å¼çš„, å¯ä»¥ä½¿ç”¨caddy adaptå‘½ä»¤æ˜¾å¼è½¬åŒ–æ–‡ä»¶ã€‚æ‰€ä»¥å³ä½¿éƒ¨åˆ†æ’ä»¶åœ¨æ–‡æ¡£ä¸­åªå†™äº†Caddyfileçš„å†™æ³•, ä½ ä¹Ÿå¯ä»¥å…ˆå†™è¿™éƒ¨åˆ†çš„é…ç½®å†™é“Caddyfileé‡Œç„¶åå†è½¬åŒ–ä¸ºjsonç»§ç»­é…ç½®\næ€»ä¸Šæ‰€è¿°, æœ€ç»ˆé€‰æ‹©äº†æœ¬åœ°ä½¿ç”¨xcaddyæ„å»ºå¸¦æœ‰vrongmeal/caddygit, WingLim/caddy-webhook , mholt/caddy-webdavè¿™ä¸‰ä¸ªæ’ä»¶çš„caddy v2.6.4åœ¨æœ¬åœ°è¿è¡Œjsonæ ¼å¼é…ç½®æ–‡ä»¶çš„æ–¹å¼å®ŒæˆæœåŠ¡å™¨çš„è·¯ç”±é…ç½®\nbitwarden bitwardenæ˜¯ä¸€ä¸ªå¼€æº, æ–¹ä¾¿çš„å¯†ç ç®¡ç†å™¨, åœ¨ç½‘é¡µ(chrome, firefox, safair)/android/ios/windows/linuxç­‰å…¨å¹³å°éƒ½æœ‰ç›¸å…³å®¢æˆ·ç«¯(ç½‘é¡µæ’ä»¶), æ”¯æŒéƒ¨ç½²åˆ°è‡ªå·±çš„æœåŠ¡å™¨æ„å»ºè‡ªå·±ä¸“å±çš„å¯†ç åº“ï¼Œæœ‰æ•ˆçš„æé«˜äº†å®‰å…¨æ€§. ä¹‹å‰caddyé…ç½®bitwardençš„æ—¶å€™, å¯ä»¥ä½¿ç”¨å®˜æ–¹çš„dockeré•œåƒ, åªç”¨æ˜ å°„ä¸€ä¸‹ç«¯å£å°±å¯ä»¥ä¸€é”®éƒ¨ç½². ç°åœ¨caddyå‡çº§åˆ°v2ä¹‹åå¥½åƒå¯¹bitwardenè¿˜ä¸é€‚é…, åªèƒ½ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„vaultwarden(bitwardençš„ä¸€ä¸ªç¬¬ä¸‰æ–¹ç‰ˆæœ¬)æ¥éƒ¨ç½²\nhugo hugoæ˜¯ä¸€ä¸ªæ–¹ä¾¿çš„ä»mdæ–‡æ¡£æ„å»ºé™æ€ç½‘é¡µçš„å·¥å…·, éå¸¸ç¬¦åˆæˆ‘ç›®å‰çš„éœ€æ±‚. ä½†æ˜¯æ³¨æ„å¾ˆå¤šç½‘ç«™çš„ä¸»é¢˜è¦æ±‚hugoæ˜¯extendç‰ˆ(hugoå®˜æ–¹ä¹Ÿæ¨èä½¿ç”¨extendç‰ˆ), åŒæ—¶ç”±äºä¸»é¢˜æ¨¡æ¿çš„æ›´æ–°, å¾ˆå¤šä¸»é¢˜å¯¹hugoçš„ç‰ˆæœ¬è¦æ±‚ä¼šæ¯”è¾ƒæ–°. ä½†aptå®‰è£…çš„æ˜¯0.55ç‰ˆçš„, ä¸ç¬¦åˆæˆ‘ç›®å‰ä¸»é¢˜çš„è¦æ±‚. å®˜æ–¹è¿˜æä¾›äº†snapå®‰è£…, ä½†æˆ‘åœ¨æœåŠ¡å™¨ä¸Šè£…çš„æ—¶å€™å‡ºç°äº†å¥½åƒè¯´ç³»ç»Ÿä¸åŒ¹é…çš„é”™è¯¯ğŸ˜”, çœ‹githubçš„issueä¸Šæœ‰äººæè¿‡ç±»ä¼¼çš„, ä¸‹é¢æœ‰ä¸ªå›ç­”è¯´ä»–å·²ç»ä¿®å¤äº†, å¯æ˜¯æˆ‘çš„è¿™ä¸ªè¿˜æ˜¯ä¸è¡Œ. æ‰€ä»¥æœ€åé‡‡ç”¨äº†åœ¨githubçš„releaseé‡Œä¸‹è½½extendç‰ˆçš„debå®‰è£…åŒ…ï¼Œç„¶åå†åœ¨æœ¬åœ°dpkg -iå®‰è£…\næ ¼å¼è¯´æ˜ æœ¬æ–‡å‡å®šä½ å·²ç»æœ‰ä¸€ä¸ªå±äºè‡ªå·±çš„æœåŠ¡å™¨å’ŒåŸŸå, å¹¶ä¸”å·²ç»æŠŠdnsè§£æå¥½äº†, å›½å†…æœåŠ¡å™¨çš„å¤‡æ¡ˆä¹Ÿä¸åœ¨æœ¬æ–‡è®¨è®ºèŒƒå›´å†…. æœ¬æ–‡ä»…åŒ…å«caddyçš„å®‰è£…é…ç½®, é…ç½®æ–‡ä»¶caddyfile.jsonçš„ç¼–å†™, hugoçš„å®‰è£…é…ç½®å’Œvaultwarden dockeré•œåƒçš„é…ç½®\næœ¬æ–‡æ¥ä¸‹æ¥åœ¨é…ç½®æ–‡ä»¶ä¸­å‡ºç°çš„å¿…éœ€éœ€è¦è¯»è€…æœ¬äººæ ¹æ®è‡ªå·±æœåŠ¡å™¨ç­‰è¿›è¡Œä¿®æ”¹çš„åœ°æ–¹ä¼šä½¿ç”¨ç±»ä¼¼@1{path}çš„æ–¹å¼ä»£æŒ‡ï¼Œä¾‹å¦‚ä½ æœ¬åœ°çš„æŸä¸ªæ–‡ä»¶å¤¹åœ°å€ä¸º/usr/local/bin, åœ¨é…ç½®æ–‡ä»¶ä¸­ä¼šä»¥@1{path}ä»£æŒ‡è¿™ä¸ªåœ°å€(æ•°å­—æŒ‡çš„æ˜¯è¿™ä¸ªæ–‡ä»¶ä¸­å‡ºç°çš„ç¬¬å‡ ä¸ª, å¦‚æœä¸¤ä¸ªåœ°æ–¹ç”¨ä¸€ä¸ªçš„è¯å°±æ˜¯ä¸€ä¸ªåœ°å€). åŒç†@1{domain}ä»£æŒ‡æ–‡ä»¶ä¸­ç¬¬ä¸€ä¸ªå‡ºç°çš„éœ€è¦ä½ ä¿®æ”¹æˆè‡ªå·±çš„åŸŸåwww.your-domain.com\nå®‰è£… caddy caddyä»å®˜æ–¹é€”å¾„aptå®‰è£…çš„æ˜¯æ²¡æœ‰æ’ä»¶çš„, æ²¡æ’ä»¶æ²¡åŠæ³•å®Œæˆæ¥ä¸‹æ¥çš„éƒ¨ç½², ä½†æ˜¯ä»aptå®‰è£…çš„ä¼šé…å¥—ç›¸å…³çš„systemdæœåŠ¡, æ–¹ä¾¿åç»­ç®¡ç†è¿è¡Œé‡å¯ç­‰. å› æ­¤å…ˆaptå®‰è£…æ²¡æœ‰æ’ä»¶çš„caddyç„¶åå†é€šè¿‡xcaddyæ¥ç¼–è¯‘å¸¦æœ‰æ’ä»¶çš„caddy, ç¼–è¯‘å®Œæˆåæ›¿æ¢æ‰ä¹‹å‰aptå®‰è£…çš„caddy\naptå®‰è£…caddy 1 2 3 4 5 apt install -y debian-keyring debian-archive-keyring apt-transport-https curl -1sLf \u0026#39;https://dl.cloudsmith.io/public/caddy/stable/gpg.key\u0026#39; | gpg --dearmor -o /usr/share/keyrings/caddy-stable-archive-keyring.gpg curl -1sLf \u0026#39;https://dl.cloudsmith.io/public/caddy/stable/debian.deb.txt\u0026#39; | tee /etc/apt/sources.list.d/caddy-stable.list apt update apt install caddy goç¯å¢ƒ ç”±äºxcaddyæ˜¯ç”±goè¯­è¨€ç¼–è¯‘å®‰è£…çš„, æ‰€ä»¥éœ€è¦å…ˆé…ç½®ç¯å¢ƒ\n1 2 3 4 5 6 7 8 9 wget https://go.dev/dl/go1.20.7.linux-amd64.tar.gz rm -rf /usr/local/go \u0026amp;\u0026amp; tar -C /usr/local -xzf go1.20.7.linux-amd64.tar.gz \u0026amp;\u0026amp; rm go1.20.7.linux-amd64.tar.gz vim ~/.bashrc #å†™å…¥æ–‡ä»¶ export PATH=$PATH:/usr/local/go/bin #ä¿å­˜æ–‡ä»¶ source ~/.bashrc xcaddy å®‰è£…xcaddy\n1 go install github.com/caddyserver/xcaddy/cmd/xcaddy@latest xcaddyç¼–è¯‘å¸¦æ’ä»¶çš„caddy\n1 2 3 4 5 export version=$(curl -s \u0026#34;https://api.github.com/repos/caddyserver/caddy/releases/latest\u0026#34; | grep tag_name | cut -f4 -d \u0026#34;\\\u0026#34;\u0026#34;) go/bin/xcaddy build ${version} \\ --with github.com/WingLim/caddy-webhook \\ --with github.com/mholt/caddy-webdav \\ --with github.com/vrongmeal/caddygit ä¹‹åä¼šç¼–è¯‘å‡ºå¸¦æœ‰è¿™ä¸‰ä¸ªæ’ä»¶çš„caddyåˆ°å½“å‰ç›®å½•, å¦‚æœä½ éœ€è¦å…¶ä»–æ’ä»¶çš„è¯, åé¢--withæ¥ç€è·Ÿæ’ä»¶çš„githubä»“åº“åœ°å€å°±è¡Œäº†\nç¼–è¯‘å®Œæˆåä½¿ç”¨whereis caddyæŸ¥çœ‹ä¹‹å‰aptå®‰è£…çš„caddyå®‰è£…åˆ°å“ªé‡Œäº†, å†ç”¨mvæŠŠåˆšç¼–è¯‘çš„å¸¦æ’ä»¶çš„æ›¿æ¢æ‰aptå®‰è£…çš„\n1 mv caddy /usr/bin/caddy hugo 1 2 3 export version=$(curl -s \u0026#34;https://api.github.com/repos/gohugoio/hugo/releases/latest\u0026#34; | grep tag_name | cut -f4 -d \u0026#34;\\\u0026#34;\u0026#34; | grep -oE \u0026#39;([0-9]+\\.?)+\u0026#39;) wget https://github.com/gohugoio/hugo/releases/download/v${version}/hugo_extended_${version}_linux-amd64.deb dpkg -i hugo_extended_${version}_linux-amd64.deb vaultwarden éœ€è¦å…ˆå®‰è£…docker, å®‰è£…å¥½åå†\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 apt-get install ca-certificates curl gnupg install -m 0755 -d /etc/apt/keyrings curl -fsSL https://download.docker.com/linux/debian/gpg | gpg --dearmor -o /etc/apt/keyrings/docker.gpg chmod a+r /etc/apt/keyrings/docker.gpg echo \u0026#34;deb [arch=\u0026#34;$(dpkg --print-architecture)\u0026#34; signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/debian \u0026#34;$(. /etc/os-release \u0026amp;\u0026amp; echo \u0026#34;$VERSION_CODENAME\u0026#34;)\u0026#34; stable\u0026#34; | tee /etc/apt/sources.list.d/docker.list \u0026gt; /dev/null apt-get update apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin docker run -d --name vaultwarden \\ -e SIGNUPS_ALLOWED=true \\ -e WEBSOCKET_ENABLED=true \\ -e LOG_FILE=/data/bitwarden.log \\ -p @1{vault_port}:80 \\ -p @2{vault_port}:3012 \\ -v /vw-data/:/data/ \\ vaultwarden/server:1.27.0 æ­¤å¤„çš„@1{vault-port}å’Œ@2{vault-port}éœ€è¦æ›¿æ¢æ‰æˆä¹‹åä½ åœ¨caddyçš„é…ç½®æ–‡ä»¶ä¸­åä»£çš„ç«¯å£, å› æ­¤å»ºè®®é…ç½®å¥½å…¶ä»–ä¹‹åå†å®‰è£…è¿™ä¸ª\né…ç½® å˜é‡è§£é‡Šå¦‚ä¸‹ï¼Œéœ€è¦å°†ä¸‹é¢æ‰€æœ‰é…ç½®æ–‡ä»¶ä¸­å‡ºç°çš„åœ°æ–¹æ›¿æ¢æˆä½ è‡ªå·±çš„\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 @1{vault_port}:80\t--caddyåä»£çš„bitwardenç«¯å£ï¼Œä¾‹å¦‚8080ï¼š80 @2{vault_port}:3012\t--caddyåä»£çš„bitwardenç«¯å£ï¼Œä¾‹å¦‚3012ï¼š3012 @3{v2ray_port}\t--caddyåä»£çš„v2rayç«¯å£ï¼Œä¾‹å¦‚2233 @1{cer_path}\t--bitwardenç½‘ç«™çš„è¯ä¹¦ceréƒ¨åˆ†ï¼Œä¾‹å¦‚usr/local/etc/ssl/bitwarden.cer @1{key_path} --bitwardenç½‘ç«™çš„è¯ä¹¦keyéƒ¨åˆ†, ä¾‹å¦‚usr/local/etc/ssl/bitwarden.key @2{cer_path}\t--blogç½‘ç«™çš„è¯ä¹¦ceréƒ¨åˆ† @2{key_path}\t--blogç½‘ç«™çš„è¯ä¹¦keyéƒ¨åˆ† @3{v2ray_path}\t--v2rayçš„è®¿é—®è·¯å¾„ï¼Œä»¥/å¼€å¤´ï¼Œä¾‹å¦‚/vvvã€‚ä½†æ˜¯ä¸èƒ½å’Œ@4{v2ray_www_path}çš„æœ€åä¸€çº§ç›¸åŒï¼Œå³å¦‚æœ@4{v2ray_www_path}æ˜¯/var/www/v2rayçš„è¯ï¼Œå°±ä¸èƒ½æ˜¯/v2ray @4{v2ray_www_path}\t--v2rayç½‘ç«™çš„å­˜æ”¾è·¯å¾„ï¼Œä¾‹å¦‚/var/www/v2ray @5{blog_path}\t--å­˜æ”¾åšå®¢ç½‘ç«™çš„åœ°å€, ä¾‹å¦‚/var/www/myblog @1{vault_domain}\t--bitwardençš„åŸŸå @2{blog_domain}\t--blogçš„åŸŸå @3{v2ray_domain}\t--v2rayçš„ä¼ªè£…åŸŸå @1{github_url}\t--å­˜æ”¾åšå®¢æ–‡æ¡£çš„githubä»“åº“åœ°å€ @1{github_token}\t--æœ‰å­˜æ”¾åšå®¢æ–‡æ¡£çš„githubä»“åº“è®¿é—®æƒé™çš„token @1{github_secret}\t--webhookçš„secret @1{v2ray_uuid}\t--v2rayé…ç½® @1{your_email}\t--æ³¨å†ŒåŸŸåæ—¶ä½¿ç”¨çš„é‚®ç®± @1{cloudflare_key}\t--cloudflareçš„key caddy caddy.service é¦–å…ˆéœ€è¦ä¿®æ”¹ä»¥ä¸‹caddy.serviceé…ç½®ç›¸å…³æœåŠ¡\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 vim /etc/systemd/system/caddy.service # caddy.service # # For using Caddy with a config file. # # Make sure the ExecStart and ExecReload commands are correct # for your installation. # # See https://caddyserver.com/docs/install for instructions. # # WARNING: This service does not use the --resume flag, so if you # use the API to make changes, they will be overwritten by the # Caddyfile next time the service is restarted. If you intend to # use Caddy\u0026#39;s API to configure it, add the --resume flag to the # `caddy run` command or use the caddy-api.service file instead. [Unit] Description=Caddy Documentation=https://caddyserver.com/docs/ After=network.target network-online.target Requires=network-online.target [Service] Type=notify User=caddy Group=caddy ExecStart=/usr/bin/caddy run --environ --config /etc/caddy/caddyfile.json ExecReload=/usr/bin/caddy reload --config /etc/caddy/caddyfile.json --force TimeoutStopSec=5s LimitNOFILE=1048576 LimitNPROC=512 PrivateTmp=true ProtectSystem=full AmbientCapabilities=CAP_NET_BIND_SERVICE [Install] WantedBy=multi-user.target chown root:root /etc/systemd/system/caddy.service chmod 644 /etc/systemd/system/caddy.service systemctl daemon-reload chown root:root /usr/bin/caddy chmod 755 /usr/bin/caddy setcap \u0026#39;cap_net_bind_service=+ep\u0026#39; /usr/bin/caddy groupadd -g 33 caddy useradd \\ -g caddy --no-user-group \\ --home-dir /var/caddy --no-create-home \\ --shell /usr/sbin/nologin \\ --system --uid 33 caddy mkdir /etc/caddy mkdir /var/www mkdir /var/caddy mkdir /etc/ssl/caddy touch /etc/caddy/caddyfile.json touch /var/log/caddy.log chown caddy:caddy /var/caddy chown -R root:caddy /etc/caddy chown -R root:caddy /etc/ssl/caddy chown -R root:caddy /var/www chmod 555 /var/caddy chmod 777 /var/www chmod 0770 /etc/ssl/caddy chown root:caddy /var/log/caddy.log chown root:root /etc/caddy/caddyfile.json chmod 770 /var/log/caddy.log chmod 644 /etc/caddy/caddyfile.json caddyfile.json æ¥ç€é…ç½®caddyfile.json\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269 270 271 272 273 274 275 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293 294 295 296 297 298 299 300 301 302 303 304 305 306 307 308 309 310 311 312 313 314 315 316 317 318 319 320 321 322 323 324 325 326 327 328 329 330 331 332 333 334 335 336 337 338 339 340 341 342 343 344 345 346 347 348 349 350 351 352 353 354 355 356 357 358 359 360 361 362 363 364 365 366 367 368 369 370 371 372 373 374 375 376 377 378 379 380 381 382 383 384 385 386 387 388 389 390 391 392 393 394 395 396 397 398 399 400 401 402 403 404 405 406 407 408 409 410 411 412 413 414 415 416 417 418 419 420 421 422 423 424 425 426 427 428 429 430 431 432 433 434 435 436 437 438 439 440 441 442 443 444 445 446 447 448 449 450 451 452 453 454 455 456 457 458 459 460 461 462 463 464 465 466 467 468 469 470 471 472 473 474 vim /etc/caddy/caddyfile.json { \u0026#34;logging\u0026#34;: { \u0026#34;logs\u0026#34;: { \u0026#34;default\u0026#34;: { \u0026#34;exclude\u0026#34;: [ \u0026#34;http.log.access.log0\u0026#34;, \u0026#34;http.log.access.log1\u0026#34;, \u0026#34;http.log.access.log2\u0026#34; ] }, \u0026#34;log0\u0026#34;: { \u0026#34;writer\u0026#34;: { \u0026#34;filename\u0026#34;: \u0026#34;/var/log/caddy.log\u0026#34;, \u0026#34;output\u0026#34;: \u0026#34;file\u0026#34;, \u0026#34;roll_keep\u0026#34;: 10, \u0026#34;roll_size_mb\u0026#34;: 10 }, \u0026#34;level\u0026#34;: \u0026#34;INFO\u0026#34;, \u0026#34;include\u0026#34;: [ \u0026#34;http.log.access.log0\u0026#34; ] }, \u0026#34;log1\u0026#34;: { \u0026#34;writer\u0026#34;: { \u0026#34;filename\u0026#34;: \u0026#34;/var/log/caddy.log\u0026#34;, \u0026#34;output\u0026#34;: \u0026#34;file\u0026#34; }, \u0026#34;include\u0026#34;: [ \u0026#34;http.log.access.log1\u0026#34; ] }, \u0026#34;log2\u0026#34;: { \u0026#34;writer\u0026#34;: { \u0026#34;filename\u0026#34;: \u0026#34;/var/log/caddy.log\u0026#34;, \u0026#34;output\u0026#34;: \u0026#34;file\u0026#34; }, \u0026#34;include\u0026#34;: [ \u0026#34;http.log.access.log2\u0026#34; ] } } }, \u0026#34;apps\u0026#34;: { \u0026#34;tls\u0026#34;: { \u0026#34;certificates\u0026#34;: { \u0026#34;load_files\u0026#34;: [ { \u0026#34;certificate\u0026#34;: \u0026#34;@1{cer_path}\u0026#34;, \u0026#34;key\u0026#34;: \u0026#34;@1{key_path}\u0026#34;, \u0026#34;tags\u0026#34;: [ \u0026#34;cert0\u0026#34; ] }, { \u0026#34;certificate\u0026#34;: \u0026#34;@2{cer_path}\u0026#34;, \u0026#34;key\u0026#34;: \u0026#34;@2{cer_path}\u0026#34;, \u0026#34;tags\u0026#34;: [ \u0026#34;cert1\u0026#34; ] } ] }, \u0026#34;automation\u0026#34;: { \u0026#34;policies\u0026#34;: [ { \u0026#34;subjects\u0026#34;: [ \u0026#34;@1{vault_domain}\u0026#34;, \u0026#34;@2{blog_domain}\u0026#34; ] }, { \u0026#34;subjects\u0026#34;: [ \u0026#34;@3{v2ray_domain}\u0026#34; ], \u0026#34;issuers\u0026#34;: [ { \u0026#34;email\u0026#34;: \u0026#34;@1{your_email}\u0026#34;, \u0026#34;module\u0026#34;: \u0026#34;acme\u0026#34; }, { \u0026#34;email\u0026#34;: \u0026#34;@1{your_email}\u0026#34;, \u0026#34;module\u0026#34;: \u0026#34;zerossl\u0026#34; } ] } ] } }, \u0026#34;http\u0026#34;: { \u0026#34;servers\u0026#34;: { \u0026#34;srv1\u0026#34;: { \u0026#34;listen\u0026#34;: [ \u0026#34;:80\u0026#34; ], \u0026#34;routes\u0026#34;: [ { \u0026#34;match\u0026#34;: [ { \u0026#34;host\u0026#34;: [ \u0026#34;@1{vault_domain}\u0026#34; ] } ], \u0026#34;handle\u0026#34;: [ { \u0026#34;handler\u0026#34;: \u0026#34;subroute\u0026#34;, \u0026#34;routes\u0026#34;: [ { \u0026#34;handle\u0026#34;: [ { \u0026#34;handler\u0026#34;: \u0026#34;static_response\u0026#34;, \u0026#34;headers\u0026#34;: { \u0026#34;Location\u0026#34;: [ \u0026#34;https://@1{vault_domain}\u0026#34; ] }, \u0026#34;status_code\u0026#34;: 302 } ] } ] } ], \u0026#34;terminal\u0026#34;: true }, { \u0026#34;match\u0026#34;: [ { \u0026#34;host\u0026#34;: [ \u0026#34;@2{blog_domain}\u0026#34; ] } ], \u0026#34;handle\u0026#34;: [ { \u0026#34;handler\u0026#34;: \u0026#34;subroute\u0026#34;, \u0026#34;routes\u0026#34;: [ { \u0026#34;handle\u0026#34;: [ { \u0026#34;handler\u0026#34;: \u0026#34;static_response\u0026#34;, \u0026#34;headers\u0026#34;: { \u0026#34;Location\u0026#34;: [ \u0026#34;https://@2{blog_domain}\u0026#34; ] }, \u0026#34;status_code\u0026#34;: 302 } ] } ] } ], \u0026#34;terminal\u0026#34;: true }, { \u0026#34;match\u0026#34;: [ { \u0026#34;host\u0026#34;: [ \u0026#34;@3{v2ray_domain}\u0026#34; ] } ], \u0026#34;handle\u0026#34;: [ { \u0026#34;handler\u0026#34;: \u0026#34;subroute\u0026#34;, \u0026#34;routes\u0026#34;: [ { \u0026#34;handle\u0026#34;: [ { \u0026#34;handler\u0026#34;: \u0026#34;static_response\u0026#34;, \u0026#34;headers\u0026#34;: { \u0026#34;Location\u0026#34;: [ \u0026#34;https://@3{v2ray_domain}\u0026#34; ] }, \u0026#34;status_code\u0026#34;: 302 } ] } ] } ], \u0026#34;terminal\u0026#34;: true } ] }, \u0026#34;srv0\u0026#34;: { \u0026#34;listen\u0026#34;: [ \u0026#34;:443\u0026#34; ], \u0026#34;tls_connection_policies\u0026#34;: [ { \u0026#34;match\u0026#34;: { \u0026#34;sni\u0026#34;: [ \u0026#34;@2{blog_domain}\u0026#34; ] }, \u0026#34;certificate_selection\u0026#34;: { \u0026#34;any_tag\u0026#34;: [ \u0026#34;cert1\u0026#34; ] } }, { \u0026#34;match\u0026#34;: { \u0026#34;sni\u0026#34;: [ \u0026#34;@1{vault_domain}\u0026#34; ] }, \u0026#34;certificate_selection\u0026#34;: { \u0026#34;any_tag\u0026#34;: [ \u0026#34;cert0\u0026#34; ] } }, { \u0026#34;match\u0026#34;: { \u0026#34;sni\u0026#34;: [ \u0026#34;@3{v2ray_domain}\u0026#34; ] }, \u0026#34;cipher_suites\u0026#34;: [ \u0026#34;TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\u0026#34;, \u0026#34;TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256\u0026#34; ], \u0026#34;protocol_min\u0026#34;: \u0026#34;tls1.2\u0026#34;, \u0026#34;protocol_max\u0026#34;: \u0026#34;tls1.3\u0026#34; }, {} ], \u0026#34;logs\u0026#34;: { \u0026#34;logger_names\u0026#34;: { \u0026#34;@3{v2ray_domain}\u0026#34;: \u0026#34;log0\u0026#34; }, \u0026#34;logger_names\u0026#34;: { \u0026#34;@1{vault_domain}\u0026#34;: \u0026#34;log1\u0026#34; }, \u0026#34;logger_names\u0026#34;: { \u0026#34;@2{blog_domain}\u0026#34;: \u0026#34;log2\u0026#34; }, \u0026#34;skip_hosts\u0026#34;: [ \u0026#34;@1{vault_domain}\u0026#34;, \u0026#34;@2{blog_domain}\u0026#34;, \u0026#34;@3{v2ray_domain}\u0026#34; ] }, \u0026#34;routes\u0026#34;: [ { \u0026#34;match\u0026#34;: [ { \u0026#34;host\u0026#34;: [ \u0026#34;@3{v2ray_domain}\u0026#34; ] } ], \u0026#34;handle\u0026#34;: [ { \u0026#34;handler\u0026#34;: \u0026#34;subroute\u0026#34;, \u0026#34;routes\u0026#34;: [ { \u0026#34;handle\u0026#34;: [ { \u0026#34;handler\u0026#34;: \u0026#34;vars\u0026#34;, \u0026#34;root\u0026#34;: \u0026#34;@4{v2ray_www_path}\u0026#34; }, { \u0026#34;encodings\u0026#34;: { \u0026#34;gzip\u0026#34;: {} }, \u0026#34;handler\u0026#34;: \u0026#34;encode\u0026#34;, \u0026#34;prefer\u0026#34;: [ \u0026#34;gzip\u0026#34; ] } ] }, { \u0026#34;handle\u0026#34;: [ { \u0026#34;handler\u0026#34;: \u0026#34;reverse_proxy\u0026#34;, \u0026#34;upstreams\u0026#34;: [ { \u0026#34;dial\u0026#34;: \u0026#34;localhost:@3{v2ray_port}\u0026#34; } ] } ], \u0026#34;match\u0026#34;: [ { \u0026#34;header\u0026#34;: { \u0026#34;Connection\u0026#34;: [ \u0026#34;*Upgrade*\u0026#34; ], \u0026#34;Upgrade\u0026#34;: [ \u0026#34;websocket\u0026#34; ] }, \u0026#34;path\u0026#34;: [ \u0026#34;@3{v2ray_path}\u0026#34; ] } ] }, { \u0026#34;handle\u0026#34;: [ { \u0026#34;handler\u0026#34;: \u0026#34;file_server\u0026#34;, \u0026#34;hide\u0026#34;: [ \u0026#34;/etc/caddy/Caddyfile\u0026#34; ] } ] } ] } ], \u0026#34;terminal\u0026#34;: true }, { \u0026#34;match\u0026#34;: [ { \u0026#34;host\u0026#34;: [ \u0026#34;@1{vault_domain}\u0026#34; ] } ], \u0026#34;handle\u0026#34;: [ { \u0026#34;handler\u0026#34;: \u0026#34;subroute\u0026#34;, \u0026#34;routes\u0026#34;: [ { \u0026#34;handle\u0026#34;: [ { \u0026#34;encodings\u0026#34;: { \u0026#34;gzip\u0026#34;: {} }, \u0026#34;handler\u0026#34;: \u0026#34;encode\u0026#34;, \u0026#34;prefer\u0026#34;: [ \u0026#34;gzip\u0026#34; ] } ] }, { \u0026#34;handle\u0026#34;: [ { \u0026#34;handler\u0026#34;: \u0026#34;reverse_proxy\u0026#34;, \u0026#34;upstreams\u0026#34;: [ { \u0026#34;dial\u0026#34;: \u0026#34;localhost:@2{vault_port}\u0026#34; } ] } ], \u0026#34;match\u0026#34;: [ { \u0026#34;path\u0026#34;: [ \u0026#34;/notifications/hub\u0026#34; ] } ] }, { \u0026#34;handle\u0026#34;: [ { \u0026#34;handler\u0026#34;: \u0026#34;reverse_proxy\u0026#34;, \u0026#34;headers\u0026#34;: { \u0026#34;request\u0026#34;: { \u0026#34;set\u0026#34;: { \u0026#34;X-Real-Ip\u0026#34;: [ \u0026#34;localhost\u0026#34; ] } } }, \u0026#34;upstreams\u0026#34;: [ { \u0026#34;dial\u0026#34;: \u0026#34;localhost:@1{vault_port}\u0026#34; } ] } ] } ] } ], \u0026#34;terminal\u0026#34;: true }, { \u0026#34;match\u0026#34;: [ { \u0026#34;host\u0026#34;: [ \u0026#34;@5{blog_domain}\u0026#34; ] } ], \u0026#34;handle\u0026#34;: [ { \u0026#34;handler\u0026#34;: \u0026#34;subroute\u0026#34;, \u0026#34;routes\u0026#34;: [ { \u0026#34;handle\u0026#34;: [ { \u0026#34;handler\u0026#34;: \u0026#34;vars\u0026#34;, \u0026#34;root\u0026#34;: \u0026#34;@5{blog_path}/public\u0026#34; }, { \u0026#34;handler\u0026#34;: \u0026#34;file_server\u0026#34;, \u0026#34;hide\u0026#34;: [ \u0026#34;/etc/caddy/Caddyfile\u0026#34; ] } ] } ] } ], \u0026#34;terminal\u0026#34;: true, \u0026#34;match\u0026#34;: [ { \u0026#34;not\u0026#34;: [ { \u0026#34;path\u0026#34;: [ \u0026#34;/webhook\u0026#34; ] } ] } ] }, { \u0026#34;handle\u0026#34;: [ { \u0026#34;handler\u0026#34;: \u0026#34;subroute\u0026#34;, \u0026#34;routes\u0026#34;: [ { \u0026#34;handle\u0026#34;: [ { \u0026#34;branch\u0026#34;: \u0026#34;main\u0026#34;, \u0026#34;handler\u0026#34;: \u0026#34;webhook\u0026#34;, \u0026#34;path\u0026#34;: \u0026#34;@5{blog_path}/content\u0026#34;, \u0026#34;repo\u0026#34;: \u0026#34;@1{github_url}\u0026#34;, \u0026#34;token\u0026#34;: \u0026#34;@1{github_token}\u0026#34;, \u0026#34;secret\u0026#34;: \u0026#34;@1{github_secret}\u0026#34;, \u0026#34;command\u0026#34;: [ \u0026#34;hugo\u0026#34;, \u0026#34;--destination\u0026#34;, \u0026#34;@5{blog_path}/public\u0026#34; ], \u0026#34;submodule\u0026#34;: true, \u0026#34;type\u0026#34;: \u0026#34;github\u0026#34; } ] } ] } ], \u0026#34;match\u0026#34;: [ { \u0026#34;path\u0026#34;: [ \u0026#34;/webhook\u0026#34; ] } ] } ] } } } } } v2ray https://github.com/zxcvos/Xray-script\nconfig.json mkdir -p /usr/local/etc/v2ray/\nmkdir -p /usr/local/etc/ssl/ecc/\nvim /usr/local/etc/v2ray/config.json\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 { \u0026#34;log\u0026#34;: { \u0026#34;access\u0026#34;: \u0026#34;/var/log/v2ray/access.log\u0026#34;, \u0026#34;error\u0026#34;: \u0026#34;/var/log/v2ray/error.log\u0026#34;, \u0026#34;loglevel\u0026#34;: \u0026#34;warning\u0026#34; }, \u0026#34;dns\u0026#34;: {}, \u0026#34;stats\u0026#34;: {}, \u0026#34;inbounds\u0026#34;: [ { \u0026#34;port\u0026#34;: @3{v2ray_port}, \u0026#34;listen\u0026#34;: \u0026#34;127.0.0.1\u0026#34;, \u0026#34;protocol\u0026#34;: \u0026#34;vmess\u0026#34;, \u0026#34;settings\u0026#34;: { \u0026#34;clients\u0026#34;: [ { \u0026#34;id\u0026#34;: \u0026#34;@1{v2ray_uuid}\u0026#34;, \u0026#34;level\u0026#34;: 0, \u0026#34;email\u0026#34;: \u0026#34;@1{your_email}\u0026#34; } ], \u0026#34;decryption\u0026#34;: \u0026#34;none\u0026#34; }, \u0026#34;streamSettings\u0026#34;: { \u0026#34;network\u0026#34;: \u0026#34;ws\u0026#34;, \u0026#34;security\u0026#34;: \u0026#34;none\u0026#34;, \u0026#34;wsSettings\u0026#34;: { \u0026#34;path\u0026#34;: \u0026#34;@3{v2ray_path}\u0026#34; } } } ], \u0026#34;outbounds\u0026#34;: [ { \u0026#34;tag\u0026#34;: \u0026#34;direct\u0026#34;, \u0026#34;protocol\u0026#34;: \u0026#34;freedom\u0026#34;, \u0026#34;settings\u0026#34;: {} }, { \u0026#34;tag\u0026#34;: \u0026#34;blocked\u0026#34;, \u0026#34;protocol\u0026#34;: \u0026#34;blackhole\u0026#34;, \u0026#34;settings\u0026#34;: {} } ], \u0026#34;routing\u0026#34;: { \u0026#34;domainStrategy\u0026#34;: \u0026#34;IPIfNonMatch\u0026#34;, \u0026#34;rules\u0026#34;: [ { \u0026#34;type\u0026#34;: \u0026#34;field\u0026#34;, \u0026#34;domain\u0026#34;: [ \u0026#34;googleapis.cn\u0026#34;, \u0026#34;goofle.cn\u0026#34; ], \u0026#34;outboundTag\u0026#34;: \u0026#34;direct\u0026#34; }, { \u0026#34;outboundTag\u0026#34;: \u0026#34;blocked\u0026#34;, \u0026#34;ip\u0026#34;: [ \u0026#34;geoip:private\u0026#34; ], \u0026#34;type\u0026#34;: \u0026#34;field\u0026#34; } ] }, \u0026#34;policy\u0026#34;: {}, \u0026#34;reverse\u0026#34;: {}, \u0026#34;transport\u0026#34;: {} } hugo 1 hugo new site @5{blog_path} ä¼šåœ¨@5{blog_path}å¤„å»ºç«‹ç½‘ç«™çš„ç›®å½•\nvaultwarden ç¼–å†™è„šæœ¬ç›‘è§†gitæ´»åŠ¨å¹¶æ›´æ–°ç½‘é¡µ æŒ‰ç†æ¥è¯´æ˜¯ä¸éœ€è¦è¿™ä¸€æ­¥çš„ï¼Œåº”è¯¥æ˜¯caddyæ¥æ”¶åˆ°githubå‘æ¥çš„webhookç„¶åå°±å¯åŠ¨ç›¸å…³æ’ä»¶æŠŠæ›´æ–°çš„ä»“åº“pullä¸‹æ¥, ç„¶åå°±è°ƒç”¨hugo --destination @5{blog_path}/publicå‘½ä»¤æ›´æ–°ç½‘é¡µäº†\nä½†å®é™…ä¸Šå‘ç°è¿™ä¸ªå‘½ä»¤å±…ç„¶æ˜¯åœ¨/æ ¹ç›®å½•ä¸‹æ‰§è¡Œçš„, å³ä½¿åœ¨caddyfile.jsoné‡ŒæŒ‡å®šroot * @5{blog_path} äº†ä¹Ÿä¸è¡Œ.\nå¼€å§‹è¿˜æƒ³æŠŠå‘½ä»¤æ¢æˆæ‰§è¡Œå…¶ä»–çš„è„šæœ¬, ç„¶ååœ¨è„šæœ¬ä¸­cdåˆ°è·¯å¾„å†æ‰§è¡Œhugoç”Ÿæˆç½‘é¡µ. ä½†æ˜¯å¥½åƒä¹Ÿæ²¡æ³•æ­£å¸¸è¿è¡Œèµ·æ¥\nåªèƒ½é€€è€Œæ±‚å…¶æ¬¡, å•ç‹¬ç¼–å†™ä¸€ä¸ªinotify.shç›‘æµ‹@5{blog_path}/content/.git/indexè¿™ä¸ªæ–‡ä»¶çš„å˜åŠ¨æƒ…å†µç„¶åå†æ‰§è¡Œæ›´æ–°ç½‘é¡µ, è„šæœ¬å¦‚ä¸‹(éœ€è¦å…ˆå®‰è£…inotify)\n1 2 3 4 5 6 #!/bin/sh filename=$@5{blog_path}/content/.git/index inotifywait -mrq --format \u0026#39;%e\u0026#39; --event create,delete,modify $filename | while read event do cd @5{blog_path} \u0026amp;\u0026amp; hugo done ä¹‹åæ‰§è¡Œnohup bash inotify.sh \u0026gt; /dev/null 2\u0026gt;\u0026amp;1è®©è„šæœ¬åœ¨åå°è¿è¡Œå°±å¯ä»¥äº†\nä¸ºç½‘ç«™ç”³è¯·è¯ä¹¦ (ä»¥cloudflareä¸ºä¾‹) å®‰è£…acme.sh\n1 2 curl https://get.acme.sh | sh source ~/.bashrc 1 2 3 export CF_Key=\u0026#34;@1{cloudflare_key}\u0026#34; export CF_Email=\u0026#34;@1{your_email}\u0026#34; acme.sh --register-account -m @1{your_email} ä¹‹åè¿è¡Œå¦‚ä¸‹å‘½ä»¤å³å¯ä¸ºblogç½‘ç«™ç”³è¯·è¯ä¹¦\n1 acme.sh --issue --dns dns_cf -d @2{blog_domain} --keylength ec-256 #--debug 2 å¦‚æœå‡ºé”™å¯ä»¥åŠ è¿™ä¸ªå‚æ•°çœ‹çœ‹å“ªé‡ŒæŠ¥é”™ å¦‚ä¸‹å‘½ä»¤å¯å°†è¯ä¹¦å®‰è£…åœ¨@2{cer_path}, @2{key_path}è·¯å¾„ä¸‹\n1 acme.sh --installcert -d @2{blog_domain} --ecc --key-file @2{key_path} --fullchain-file @2{cer_path} --force 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 vim /etc/sysctl.conf # max open files fs.file-max = 51200 # max read buffer net.core.rmem_max = 67108864 # max write buffer net.core.wmem_max = 67108864 # default read buffer net.core.rmem_default = 65536 # default write buffer net.core.wmem_default = 65536 # max processor input queue net.core.netdev_max_backlog = 4096 # max backlog net.core.somaxconn = 4096 # resist SYN flood attacks net.ipv4.tcp_syncookies = 1 # reuse timewait sockets when safe net.ipv4.tcp_tw_reuse = 1 # turn off fast timewait sockets recycling net.ipv4.tcp_tw_recycle = 0 # short FIN timeout net.ipv4.tcp_fin_timeout = 30 # short keepalive time net.ipv4.tcp_keepalive_time = 1200 # outbound port range net.ipv4.ip_local_port_range = 10000 65000 # max SYN backlog net.ipv4.tcp_max_syn_backlog = 4096 # max timewait sockets held by system simultaneously net.ipv4.tcp_max_tw_buckets = 5000 # TCP receive buffer net.ipv4.tcp_rmem = 4096 87380 67108864 # TCP write buffer net.ipv4.tcp_wmem = 4096 65536 67108864 # turn on path MTU discovery net.ipv4.tcp_mtu_probing = 1 # for high-latency network net.core.default_qdisc=fq net.ipv4.tcp_congestion_control = bbr sysctl -p apt install libcap2-bin setcap \u0026#39;cap_net_bind_service=+ep\u0026#39; /usr/bin/caddy chown root:root /usr/bin/caddy chown -R root:root /etc/caddy chown -R root:www-data /etc/ssl/caddy chown root:www-data /var/log/caddy.log chown root:root /etc/systemd/system/caddy.service chmod 755 /usr/bin/caddy chmod 770 /etc/ssl/caddy chmod 770 /var/log/caddy.log chmod 644 /etc/systemd/system/caddy.service chown root:root /usr/local/etc/v2ray/v2ray.cer chown root:root /usr/local/etc/v2ray/v2ray.key chmod 644 /usr/local/etc/v2ray/v2ray.cer chmod 644 /usr/local/etc/v2ray/v2ray.key chown root:root /usr/local/etc/ssl/ecc/password.cer chown root:root /usr/local/etc/ssl/ecc/password.key chmod 644 /usr/local/etc/ssl/ecc/password.cer chmod 644 /usr/local/etc/ssl/ecc/password.key chown root:root /usr/local/etc/v2ray/txt.cer chown root:root /usr/local/etc/v2ray/txt.key chmod 644 /usr/local/etc/v2ray/txt.cer chmod 644 /usr/local/etc/v2ray/txt.key mkdir /var/www/public vim /var/www/public/index.html å¸¸ç”¨å‘½ä»¤è¡¨ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 bash \u0026lt;(curl -L -s check.unlock.media) acme: export CF_Key=\u0026#34;\u0026#34; export CF_Email=\u0026#34;\u0026#34; acme.sh --register-account -m example@gmail.com acme.sh --issue --dns dns_cf -d example.com --keylength ec-256 --debug 2 acme.sh --installcert -d example.com --ecc --key-file /usr/local/etc/ssl/example.key --fullchain-file /usr/local/etc/ssl/example.cer --force caddy: vim /etc/caddy/caddyfile.json systemctl daemon-reload caddy list-modules\t#æŸ¥çœ‹caddyå®‰è£…äº†å“ªäº›æ’ä»¶ journalctl --boot -u caddy.service\t#æŸ¥çœ‹caddyè¯¦ç»†è¿è¡Œæ—¥å¿— systemctl restart caddy \u0026amp;\u0026amp; systemctl status caddy\t#é‡å¯caddyå¹¶æŸ¥çœ‹è¿è¡ŒçŠ¶æ€ v2rayï¼š vim /usr/local/etc/v2ray/config.json systemctl daemon-reload systemctl stop v2ray systemctl restart v2ray \u0026amp;\u0026amp; systemctl status v2ray journalctl -u v2ray bash install-release.sh\t#æ›´æ–°v2rayç‰ˆæœ¬ ufw: utf allow 80\t#é˜²ç«å¢™å¼€å¯80ç«¯å£å…è®¸å¤–ç•Œè®¿é—®ï¼Œ éœ€è¦æå‰aptå®‰è£…ufw ufw delete 80\t#å…³é—­80ç«¯å£ ufw status numbered\t#æŸ¥çœ‹å¼€å¯äº†å“ªäº›ç«¯å£ dockerï¼š docker run -d --name vaultwarden \\ -e SIGNUPS_ALLOWED=true \\ -e WEBSOCKET_ENABLED=true \\ -e LOG_FILE=/data/bitwarden.log \\ -p @1{vault_port}:80 \\ -p @2{vault_port}:3012 \\ -v /vw-data/:/data/ \\ vaultwarden/server:1.27.0 xcaddyï¼š xcaddy build v2.6.0 \\ --with github.com/WingLim/caddy-webhook \\ --with github.com/mholt/caddy-webdav \\ --with github.com/vrongmeal/caddygit inotify: nohup bash inotify.sh \u0026gt; /dev/null 2\u0026gt;\u0026amp;1 å…¶ä»– æ­å»ºæ‰€ç”¨çš„æ‰€æœ‰é…ç½®æ–‡ä»¶å¦‚ä¸Šæ‰€ç¤º, æ¥ä¸‹æ¥å†™å†™æˆ‘åœ¨æ­å»ºä¸­é‡åˆ°çš„ä¸€äº›é—®é¢˜\nåŸæœ¬v2rayä½¿ç”¨çš„æ˜¯h2+tlsåè®®, ä½†æ˜¯ä¼¼ä¹æ²¡æ³•åœ¨caddy v2ä¸­æ­£å¸¸è¿è¡Œ, ç„¶åçœ‹åˆ°å¥½å¤šæ•™ç¨‹éƒ½æ˜¯ç”¨ws, æˆ‘å°±ä¹Ÿæ”¹æˆäº†ws, ç„¶åå°±é¡ºåˆ©è¿è¡Œäº† bitwardenä¹‹å‰çš„å®˜æ–¹dockeré•œåƒæ˜¯å¯ä»¥ç›´æ¥ç›‘å¬443ç«¯å£ä¼ æ¥çš„httpsè¯·æ±‚. ä½†æ–°ç‰ˆçš„Vaultwardenè¦é…å¤‡httpsçš„è¯å¥½åƒå¾ˆéº»çƒ¦, å¹¶ä¸”ç”³è¯·çš„è¯ä¹¦æ˜¯åœ¨dockerå®¹å™¨é‡Œçš„, caddyæ— æ³•è®¿é—®. ä½†å®é™…ä¸Šå¯ä»¥å…ˆç»™åŸŸåç”³è¯·è¯ä¹¦, httpsçš„è¯·æ±‚å‘ç»™caddyä¹‹åå†è®©caddyè½¬å‘åˆ°aultwardençš„dockerå®¹å™¨æ˜ å°„çš„80ç«¯å£é‚£é‡Œ. è¿™æ ·å®é™…è®¿é—®çš„æ—¶å€™ä¾ç„¶æ˜¯httpsåŠ å¯†è®¿é—®. ä¸ç”¨æ‹…å¿ƒå®‰å…¨é—®é¢˜ å‚è€ƒèµ„æ–™ åœ¨æ­å»ºè¿™ç¯‡åšå®¢æ—¶å‚è€ƒäº†ä»¥ä¸‹é“¾æ¥, æ„Ÿè°¢å„ä½å¤§ä½¬çš„åˆ†äº«\ncaddy: Caddy2 ç®€æ˜æ•™ç¨‹\nåˆ©ç”¨Caddyå®ç°Hugoä¸ªäººåšå®¢çš„è‡ªåŠ¨åŒ–éƒ¨ç½²\nvrongmeal/caddygit\nWingLim/caddy-webhook\nWingLim/caddy-webhook\nLadderOperator/docker-caddy2-hugo-alidns\ncaddy community\nvaultwarden: dani-garcia/vaultwarden\nhugo: hugo-command-usage\nHugo ç›®å½•ç»„ç»‡\nHugo é™æ€åšå®¢é£Ÿç”¨æŒ‡å—\nStackä¸»é¢˜\n","date":"2023-03-16T02:02:45+08:00","image":"https://raw.githubusercontent.com/TioeAre/imageHost/main/pictures/84738802_p0_master1200.jpg","permalink":"https://www.blog.tioe.xyz/daily/2023.03.16/","title":"æ­å»ºè‡ªå·±çš„ç¬¬ä¸€ç¯‡åšå®¢"}]